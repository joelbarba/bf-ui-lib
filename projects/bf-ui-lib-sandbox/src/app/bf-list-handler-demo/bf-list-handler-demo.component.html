<h2>{{name}}</h2>
<hr/>
<h5>{{desc}}</h5>
<p>
  This class generates an object that encapsulates the default behaviour we usually need to render a list in the UI.
</p>
<p>
  The object generated with BfListHandler is a “mini reducer” that handles the state for the list and all its configuration.
  <br>It provides an observable <b>render$</b> which we can subscribed to and react to any change on the state.
  This returns the whole configuration object though.
  <br>If you need to subscribe only to the list array to render, there is another observable <b>renderList$</b>,
  that returns the list to display on the view (renderedList) so we can easily use | async.
</p>

<div class="row marT40">
  <!--<bf-input class="col-4" bfLabel="Filter any" bfIcon="icon-search"-->
  <!--          [(ngModel)]="bpList.filterText" (ngModelChange)="bpList.filter($event)">-->
  <!--</bf-input>-->
  <bf-input class="col-4" bfLabel="Filter username" bfIcon="icon-search"
            [(ngModel)]="bpList.filters.username" (ngModelChange)="bpList.filter($event, 'username')">
  </bf-input>
  <bf-input class="col-4" bfLabel="Filter email" bfIcon="icon-search"
            [(ngModel)]="bpList.filters.email" (ngModelChange)="bpList.filter($event, 'email')">
  </bf-input>
  <div class="col-12">
    <bf-btn bfText=".prevPage()" (bfClick)="bpList.prevPage()"
            bfIcon="icon-arrow-left6" bfIconPos="left">
    </bf-btn>
    <bf-btn bfText=".nextPage()" (bfClick)="bpList.nextPage()"></bf-btn>
    <bf-btn bfText=".goToPage(2)" (bfClick)="bpList.goToPage(2)"></bf-btn>
    <bf-btn bfText=".paginate(20)" (bfClick)="bpList.paginate(20)"></bf-btn>
    <bf-btn bfText="orderConf.setField('username')" (bfClick)="bpList.orderConf.setField('username')"></bf-btn>
    <bf-btn bfText=".load(data)" (bfClick)="bpList.load(getRandomData())"></bf-btn>
    <bf-btn bfText=".loader$.next(data)" (bfClick)="asyncLoad()"></bf-btn>
    <bf-btn bfType="add" bfText=".add({...})" (bfClick)="addItem()"></bf-btn>
  </div>
  <div class="col-12 padT10">
    rowsPerPage={{bpList.rowsPerPage}}
    , totalItems={{bpList.totalItems}}
    , totalFiltered={{bpList.totalFiltered}}
    , renderedItems={{bpList.renderedItems}}
    , currentPage={{bpList.currentPage}}
    , totalPages={{bpList.totalPages}}
    , loadingStatus={{bpList.loadingStatus}}
    , backFilter={{bpList.backFilter | json}}
  </div>
</div>
<div class="row whiteBg">
  <bf-list-paginator class="col-12"
                     [bfCtrl]="bpList"
                     bfShowSelector="true">
  </bf-list-paginator>
</div>
<div class="row">
  <div class="col-12" [bfLoadingSpinner]="bpList.loadingStatus === 4">
    <ul class="list-unstyled table-list">
      <li class="list-header">
        <bf-list-header-col class="col-1" colTitle="Id"         fieldName="id"        [orderConf]="bpList.orderConf"></bf-list-header-col>
        <bf-list-header-col class="col-2" colTitle="Username"   fieldName="username"  [orderConf]="bpList.orderConf"></bf-list-header-col>
        <bf-list-header-col class="col-4" colTitle="Email"></bf-list-header-col>
        <bf-list-header-col class="col-4" colTitle="Full Name"></bf-list-header-col>
      </li>

      <bf-list-placeholder [hidden]="bpList.loadingStatus > 1" [bfColumns]="[1, 2, 4, 4, 1]"></bf-list-placeholder>
      <li class="list-row" [hidden]="bpList.loadingStatus <= 1"
          *ngFor="let item of bpList.renderList$ | async">
        <div class="col-1"><h5>{{item.id}}</h5></div>
        <div class="col-2"><h5>{{item.username}}</h5></div>
        <div class="col-4"><h5>{{item.email}}</h5></div>
        <div class="col-4"><h5>{{item.first_name + ' ' + item.last_name}}</h5></div>
        <div class="col-1 text-right">
          <bf-btn bfText="" bfType="delete" (bfClick)="deleteItem(item)"></bf-btn>
          <bf-btn bfText="" bfType="edit"   (bfClick)="editItem(item)"></bf-btn>
        </div>
      </li>
    </ul>
  </div>
</div>










<hr>
<h5 class="mt-4">Methods / Members:</h5>
<!--<pre>{{api}}</pre>-->

<hr>
<div class="row marT40">
  <div class="col-12">
    <p>
      There are 4 basic types of actions that trigger a change on a rendering of the list:
    </p>
    <ul>
      <li>content → Should the source of the list changes (data).</li>
      <li>filter → If a filter is applied to the content, to produce only the matches in the rendered list</li>
      <li>order → If the rendered list should be ordered differently</li>
      <li>paginate → In case a pagination should be applied, the rendered list is just the current page to show</li>
    </ul>
    <p>
      Based on these, the class provides a dispatcher with different actions to apply, and then recalculate the state
      to output the new rendered list. Shortcut methods are available to trigger all those actions.
      <br>
      To render the list the actions are applied in the same order: Full content → filter → order → paginate.
    </p>
  </div>
  <!--<div class="col-5">-->
  <!--  <img style="max-width: 500px;" src="assets/listHandler.png">-->
  <!--</div>-->
</div>

<hr>

<div class="row marT40">

  <div class="col-6">
    <h5 class="marB20">Setup</h5>
    <p>When an instance is generated some basic parameters can be set directly</p>
    <div class="code-box padV10 padH15">
      <pre style="font-size: 16px;">{{example1}}</pre>
    </div>
  </div>

  <div class="col-6">
    <h5 class="marB20">Loading</h5>
    <p> There are 2 ways to load the content to the list: </p>
    <ul>
      <li> <b>load</b>(data) → You can manually load an array passing it as a parameter </li>
      <li> <b>setLoader</b>(loader$) → You pass an observable that emits the content of the list as its output </li>
    </ul>
    <div class="code-box padV10 padH15">
      <pre style="font-size: 16px;">{{example2}}</pre>
    </div>
  </div>

</div>






<hr>
<h5 class="marB20">Full Example:</h5>

<div *ngIf="false">
  <div class="row whiteBg padB15">
    <bf-input class="col-4"
              bfLabel="Filter (any)"
              bfIcon="icon-search"
              [(ngModel)]="myList.filterText"
              (ngModelChange)="myList.filter($event)">
    </bf-input>
    <div class="col-8 marT20 text-right">
    </div>
    <div class="col-12">
      <bf-btn bfText=".prevPage()" (bfClick)="myList.prevPage()"
              bfIcon="icon-arrow-left6" bfIconPos="left">
      </bf-btn>
      <bf-btn bfText=".nextPage()" (bfClick)="myList.nextPage()"></bf-btn>
      <bf-btn bfText=".goToPage(2)" (bfClick)="myList.goToPage(2)"></bf-btn>
      <bf-btn bfText=".paginate(20)" (bfClick)="myList.paginate(20)"></bf-btn>
      <bf-btn bfText="orderConf.setField('username')" (bfClick)="myList.orderConf.setField('username')"></bf-btn>
      <bf-btn bfText=".load(data)" (bfClick)="myList.load(getRandomData())"></bf-btn>
      <bf-btn bfText=".loader$.next(data)" (bfClick)="asyncLoad()"></bf-btn>
      <bf-btn bfType="add" bfText=".add({...})" (bfClick)="addItem()"></bf-btn>
    </div>
    <div class="col-12 padT10">
      rowsPerPage={{myList.rowsPerPage}}
      , totalItems={{myList.totalItems}}
      , totalFiltered={{myList.totalFiltered}}
      , renderedItems={{myList.renderedItems}}
      , currentPage={{myList.currentPage}}
      , totalPages={{myList.totalPages}}
      , loadingStatus={{myList.loadingStatus}}
    </div>
  </div>


  <div class="row whiteBg">
    <bf-list-paginator class="col-12" [bfCtrl]="myList" bfShowSelector="true"></bf-list-paginator>
  </div>

  <div class="row">
    <div class="col-12">
      <ul class="list-unstyled table-list">
        <li class="list-header">
          <bf-list-header-col class="col-1" colTitle="Id"         fieldName="id"        [orderConf]="myList.orderConf"></bf-list-header-col>
          <bf-list-header-col class="col-2" colTitle="Username"   fieldName="username"  [orderConf]="myList.orderConf"></bf-list-header-col>
          <bf-list-header-col class="col-4" colTitle="Email"></bf-list-header-col>
          <bf-list-header-col class="col-4" colTitle="Full Name"></bf-list-header-col>
        </li>

        <bf-list-placeholder [hidden]="myList.loadingStatus > 1" [bfColumns]="[1, 2, 4, 4, 1]"></bf-list-placeholder>
        <li class="list-row" [hidden]="myList.loadingStatus <= 1"
            *ngFor="let item of myList.renderList$ | async">
          <div class="col-1"><h5>{{item.id}}</h5></div>
          <div class="col-2"><h5>{{item.username}}</h5></div>
          <div class="col-4"><h5>{{item.email}}</h5></div>
          <div class="col-4"><h5>{{item.first_name + ' ' + item.last_name}}</h5></div>
          <div class="col-1 text-right">
            <bf-btn bfText="" bfType="delete" (bfClick)="deleteItem(item)"></bf-btn>
            <bf-btn bfText="" bfType="edit"   (bfClick)="editItem(item)"></bf-btn>
          </div>
        </li>
      </ul>
    </div>
  </div>

</div>

<hr>
<div class="row">
  <div class="col-7">
    <div class="examples-table">
      <div class="code-box padV10 padH15">
        <pre style="font-size: 12px;">{{viewExample}}</pre>
      </div>
    </div>
  </div>

  <div class="col-5">
    <div class="examples-table">
      <div class="code-box padV10 padH15">
        <pre style="font-size: 12px;">{{codeExample}}</pre>
      </div>
    </div>
  </div>
</div>










<hr>
<h5 class="marB20">Filtering</h5>
<p>By default the list comes with a free filter text <b>.filterText</b> which can be set externally. Changing it however does not
  trigger any filter.
  <br>To set a filter and apply it you can call <b>.filter(value)</b>, so the filtering is applied and render$
  emits a new list based on the new criteria.
</p>
By default, the filtering function goes through all the items in the list, and selects the fields to filter by (.filterField[] array).
Then it tries to match the <b>.filterText</b> (not case sensitive) to all of them, and if any match, it selects the item to be rendered.
<p>
  If a different filter needs to be applied, you can extend the function <b>.filterList()</b> to be used instead, providing a custom matching condition
  It should return the filtered list.
</p>
<div class="code-box padV10 padH15">
  <pre style="font-size: 16px;">{{example3}}</pre>
</div>
<p class="marT15">The state produces a parameter <b>totalFiltered</b> to know the total number of filtered items before pagination is applied.
</p>


<hr>
<h5 class="marB20">Ordering</h5>
<p>
  To set the fields you want to order by you can set them on creation passing an array into <b>orderFields['field1', 'field2', ...]</b>.
  You can also specify the order ascendant (false) / descendent (true) with parameter <b>orderReverse</b>.
  <br>
  Every time the list renders, the order will be applied comparing the first field of that array.
  In case of same value of that field, second will be looked up, and so on.
</p>
<p>
  This configuration is held in the class into an object named <b>orderConf:</b> fields[], reverse, setField().
  To change the order fields dynamically use method <b>.orderConf.setField('xxx')</b>. This will add the given field to the
  first position in .orderField.fields[], swapping it if it's already there.
</p>
<p>
  The <b>orderConf</b> object is meant to be used along side component <b><{{'bf-list-header-col'}}></b>, so no extra configuration is needed.
  Just inject the object into <b>[orderConf]</b> parameter and it will handle everything.
</p>
<div class="code-box padV10 padH15">
  <pre style="font-size: 16px;">{{example4}}</pre>
</div>

<hr>
<h5 class="marB20">Pagination</h5>
<p>
  You can set the default values for pagination on creation using parameters <b>rowsPerPage</b> and <b>totalPages</b>.
  They can also be changed later. To apply no pagination, set rowsPerPage = 0.
</p>
<p>
  Every time the list is rendered, the filtered and ordered list will be offset into a page based on the parameters
  currentPage and rowsPerPage.
  <br>
  To control the pagination there are multiple shortcuts that can be applied:
</p>
<ul>
  <li><b>paginate</b>(rowsPerPage) → This changes the configuration of the pagination, applying a different number of rows per page</li>
  <li><b>goToPage</b>(pageNum) → This will change the current page to the given one.</li>
  <li><b>nextPage</b>() → To automatically jump to the next page</li>
  <li><b>prevPage</b>() → To automatically jump to the previous page</li>
</ul>
<p>
  Those methods are ready to work alon side the pagination component <b><{{'bf-list-paginator'}}></b> using <b>[bfCtrl]</b> object parameter.
</p>
<div class="code-box padV10 padH15">
  <pre style="font-size: 16px;">{{example5}}</pre>
</div>



<hr>
<h5 class="marB20">Content Management</h5>
<p>
When the data is loaded into the list, a reference is held to the original array, so any modification on the objects
is going to be reflected on the original data.
To ease this task, every time the data is loaded some management methods are extended on the items of the list too,
as shortcuts for list manipulation purposes.
</p>
<p>
  Every item is extended a <b>$save({{'{...}'}})</b> and <b>$remove()</b> function. Those functions will also trigger the list rendering, so
  there's no need to do it manually after.
  <br>
  There is also a global function <b>.add({{'{...}'}})</b> to insert new items into the list.
</p>

<div class="code-box padV10 padH15">
  <pre style="font-size: 16px;">{{example6}}</pre>
</div>



